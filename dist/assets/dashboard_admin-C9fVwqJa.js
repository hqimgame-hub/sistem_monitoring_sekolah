import"./style-Cznge8x3.js";import{a as X,d as m,s as Yt}from"./firebase_init-IrZITGwD.js";import{r as Te}from"./Navbar-z9BVbuuM.js";import{r as Me}from"./Sidebar-Ds6DUahJ.js";import{signInWithEmailAndPassword as Vt,createUserWithEmailAndPassword as Gt,signOut as _e}from"https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";import{updateDoc as $,doc as y,serverTimestamp as $t,deleteDoc as J,getDocs as I,query as ie,collection as E,where as Ke,setDoc as be,getDoc as He,addDoc as he}from"https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";import{ref as Zt,uploadBytes as ea,getDownloadURL as ta}from"https://www.gstatic.com/firebasejs/11.0.1/firebase-storage.js";import"https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";const ye=JSON.parse(localStorage.getItem("userData"));(!ye||!["admin","guru"].includes(ye.role)||ye.role==="guru"&&!ye.roles?.includes("piket"))&&(alert("Akses ditolak! Hanya admin atau guru petugas piket yang boleh mengakses."),window.location.href="index.html");Vt(X,"admin@sekolah.com","admin123").then(()=>console.log("‚úÖ Login admin berhasil")).catch(P=>console.warn("Login admin otomatis gagal:",P.message));function p(P=!0){const T=document.getElementById("loadingOverlay");T&&T.classList.toggle("hidden",!P)}function o(P,T="bg-blue-600"){const M=document.createElement("div");M.className=`${T} text-white px-4 py-2 rounded shadow mb-2 fixed right-4 top-4 z-50 max-w-sm`,M.innerText=P,document.body.appendChild(M),setTimeout(()=>M.remove(),3e3)}window.addEventListener("DOMContentLoaded",async()=>{const P=JSON.parse(localStorage.getItem("userData"));typeof Te=="function"&&Te({title:"Dashboard Admin",userEmail:P?.email||"admin@sekolah.com",onLogout:()=>{_e(X).then(()=>{localStorage.removeItem("userData"),window.location.href="index.html"})}}),typeof Me=="function"&&Me([{id:"tabGuru",label:"Data Akun",icon:'<i class="bi bi-people text-xl"></i>',onClick:()=>{_("sectionGuru")}},{id:"tabSiswa",label:"Data Siswa",icon:'<i class="bi bi-person-badge text-xl"></i>',onClick:()=>{_("sectionSiswa"),console.log("Loading siswa data..."),A()}},{id:"tabJenis",label:"Jenis Pelanggaran",icon:'<i class="bi bi-exclamation-triangle text-xl"></i>',onClick:()=>{_("sectionJenis"),typeof j=="function"&&j()}},{id:"tabAbsensi",label:"Dashboard Absensi",icon:'<i class="bi bi-calendar-check text-xl"></i>',onClick:()=>{_("sectionAbsensi"),typeof Y=="function"&&Y()}}]);const T=document.getElementById("formUser"),M=document.getElementById("formSiswa"),Tt=document.getElementById("tableUser"),Mt=document.getElementById("tableSiswa"),z=document.getElementById("tableJenis"),B=document.getElementById("filterKelas"),C=document.getElementById("filterRole"),R=document.getElementById("kelasWali"),le=document.getElementById("waliKelas"),F=document.getElementById("kelasContainer"),we=document.getElementById("kelasSelectSiswa"),oe=document.getElementById("modalEditGuru"),ke=document.getElementById("formEditGuru"),Ue=document.getElementById("editGuruId"),qe=document.getElementById("editGuruNama"),Je=document.getElementById("editGuruEmail"),Pe=document.getElementById("editGuruMapel"),Ne=document.getElementById("editGuruRole"),Xe=document.getElementById("btnCloseEditGuru"),re=document.getElementById("modalEditUser"),Ee=document.getElementById("formEditUser"),ze=document.getElementById("editUserId"),Re=document.getElementById("editUserNama"),Fe=document.getElementById("editUserEmail"),We=document.getElementById("editUserRole"),Oe=document.getElementById("editUserMapel"),Qe=document.getElementById("editUserKelas"),W=document.getElementById("editUserKelasWali"),Ye=document.getElementById("btnCloseEditUser"),Ve=document.getElementById("btnImportGuru"),Ze=document.getElementById("fileGuru"),et=document.getElementById("btnImportSiswa"),ve=document.getElementById("fileSiswa"),tt=document.getElementById("btnDownloadGuruFormat"),at=document.getElementById("btnDownloadSiswaFormat"),nt=document.getElementById("btnDownloadSiswa"),st=document.getElementById("btnDownloadKartu"),it=document.getElementById("btnGenerateQR"),lt=document.getElementById("btnLogout"),xe=document.getElementById("tabGuru"),Ie=document.getElementById("tabSiswa"),_t=document.getElementById("tabJenis"),Kt=document.getElementById("tabAbsensi"),ot=document.getElementById("sectionGuru"),rt=document.getElementById("sectionSiswa");document.getElementById("sectionJenis"),document.getElementById("sectionAbsensi");function _(t){console.log(`üîÑ showSection called with: ${t}`);const e=document.getElementById("sectionGuru"),a=document.getElementById("sectionSiswa"),n=document.getElementById("sectionJenis"),s=document.getElementById("sectionAbsensi");console.log(`üìä Before hiding - Guru: ${!e?.classList.contains("hidden")}, Siswa: ${!a?.classList.contains("hidden")}, Jenis: ${!n?.classList.contains("hidden")}, Absensi: ${!s?.classList.contains("hidden")}`),[e,a,n,s].forEach(l=>{l&&(l.classList.add("hidden"),console.log(`‚úÖ Hidden: ${l.id}`))}),[xe,Ie,_t,Kt].forEach(l=>{l&&l.classList.remove("bg-blue-500","text-white","bg-yellow-500","bg-purple-500")});const i=document.getElementById(t);i?(i.classList.remove("hidden"),console.log(`‚úÖ Showing: ${t}`),console.log(`üìä After showing - Guru: ${!e?.classList.contains("hidden")}, Siswa: ${!a?.classList.contains("hidden")}, Jenis: ${!n?.classList.contains("hidden")}, Absensi: ${!s?.classList.contains("hidden")}`)):console.error(`‚ùå Tab target not found: ${t}`)}ot&&!ot.classList.contains("hidden")?xe&&xe.classList.add("bg-blue-500","text-white"):rt&&!rt.classList.contains("hidden")&&Ie&&Ie.classList.add("bg-blue-500","text-white");const K=document.getElementById("tabTambahAkun"),H=document.getElementById("tabDaftarAkun"),dt=document.getElementById("subSectionTambahAkun"),ct=document.getElementById("subSectionDaftarAkun");function de(t){dt&&dt.classList.add("hidden"),ct&&ct.classList.add("hidden"),K&&(K.classList.remove("bg-blue-500","text-white"),K.classList.add("bg-gray-300")),H&&(H.classList.remove("bg-blue-500","text-white"),H.classList.add("bg-gray-300"));const e=document.getElementById(t);e&&(e.classList.remove("hidden"),t==="subSectionTambahAkun"&&K?(K.classList.remove("bg-gray-300"),K.classList.add("bg-blue-500","text-white")):t==="subSectionDaftarAkun"&&H&&(H.classList.remove("bg-gray-300"),H.classList.add("bg-blue-500","text-white")))}K&&K.addEventListener("click",()=>de("subSectionTambahAkun")),H&&H.addEventListener("click",()=>de("subSectionDaftarAkun")),de("subSectionDaftarAkun");async function Le(t,e){return new Promise((a,n)=>{t.toBlob(async s=>{try{const i=Zt(Yt,e);await ea(i,s);const l=await ta(i);a(l)}catch(i){n(i)}})})}async function Ht(){if(!(!R&&!B))try{const t=await I(E(m,"kelas"));R&&(R.innerHTML='<option value="">-- Pilih Kelas --</option>'),B&&(B.innerHTML='<option value="">-- Semua Kelas --</option>'),t.forEach(e=>{const a=e.data(),n=a.namaKelas||a.name||"";if(n){if(R){const s=document.createElement("option");s.value=n,s.textContent=n,R.appendChild(s)}if(B){const s=document.createElement("option");s.value=n,s.textContent=n,B.appendChild(s)}}})}catch(t){console.error("Gagal load kelas:",t)}}le&&le.addEventListener("change",()=>{le.checked?(F&&F.classList.remove("hidden"),Ht()):F&&F.classList.add("hidden")});async function Ut(){const t=document.getElementById("listMapelCheckbox");if(t){t.innerHTML='<p class="text-gray-400 text-sm col-span-full italic">‚è≥ Memuat daftar mapel...</p>';try{const e=await I(E(m,"mapel"));if(e.empty){t.innerHTML='<p class="text-gray-500 italic col-span-full">Belum ada data mapel di Firestore</p>';return}t.innerHTML="",e.forEach(a=>{const n=a.data(),s=document.createElement("label");s.className="flex items-center space-x-2 p-1";const i=document.createElement("input");i.type="checkbox",i.value=n.nama,i.className="mapelCheckbox w-4 h-4 text-blue-600";const l=document.createElement("span");l.textContent=n.nama,s.appendChild(i),s.appendChild(l),t.appendChild(s)})}catch(e){console.error("Gagal memuat mapel:",e),t.innerHTML='<p class="text-red-500 text-sm col-span-full">Gagal memuat data mapel</p>'}}}async function qt(){const t=document.getElementById("listKelasCheckbox");if(t){t.innerHTML='<p class="text-gray-400 text-sm col-span-full italic">‚è≥ Memuat daftar kelas...</p>';try{const e=await I(E(m,"kelas"));if(e.empty){t.innerHTML='<p class="text-gray-500 italic col-span-full">Belum ada data kelas di Firestore</p>';return}t.innerHTML="",e.forEach(a=>{const n=a.data(),s=document.createElement("label");s.className="flex items-center space-x-2 p-1";const i=document.createElement("input");i.type="checkbox",i.value=n.namaKelas,i.className="kelasDiajarCheckbox w-4 h-4 text-green-600";const l=document.createElement("span");l.textContent=n.namaKelas,s.appendChild(i),s.appendChild(l),t.appendChild(s)})}catch(e){console.error("Gagal memuat kelas:",e),t.innerHTML='<p class="text-red-500 text-sm col-span-full">Gagal memuat data kelas</p>'}}}async function Jt(){try{const t=await I(E(m,"kelas"));if(t.empty){console.warn("‚ö†Ô∏è Koleksi 'kelas' kosong di Firestore.");return}const e=[];t.forEach(n=>{const s=n.data(),i=s.namaKelas||s.name||"";i&&e.push(i)}),["kelasSiswa","filterKelas","filterAbsensiKelas","editUserKelasWali"].forEach(n=>{const s=document.getElementById(n);s&&(s.innerHTML='<option value="">-- Pilih Kelas --</option>',e.forEach(i=>{const l=document.createElement("option");l.value=i,l.textContent=i,s.appendChild(l)}))}),console.log("‚úÖ Dropdown kelas berhasil dimuat:",e)}catch(t){console.error("Gagal memuat daftar kelas:",t)}}let O=[],Be=1;async function D(t="",e=1,a="10"){const n=Tt||document.getElementById("tableUser");if(n){n.innerHTML="";try{const s=E(m,"users"),i=t?ie(s,Ke("role","==",t)):ie(s),l=await I(i);if(O=[],l.forEach(d=>{const h=d.data();O.push({id:d.id,...h})}),O.length===0){n.innerHTML='<tr><td colspan="11" class="p-3 text-gray-500 italic">Belum ada data pengguna</td></tr>';return}const r=a==="all"?O.length:parseInt(a),g=Math.ceil(O.length/r),c=(e-1)*r,w=c+r,u=O.slice(c,w);let f=c+1;u.forEach(d=>{Array.isArray(d.roles)||(d.roles=[]);let h="-";Array.isArray(d.mapel)&&d.mapel.length?h=d.mapel.join(", "):typeof d.mapel=="string"&&d.mapel.trim()&&(h=d.mapel);let k="-";Array.isArray(d.kelasDiajar)&&d.kelasDiajar.length?k=d.kelasDiajar.join(", "):typeof d.kelasDiajar=="string"&&d.kelasDiajar.trim()&&(k=d.kelasDiajar);const L=d.kelas||"-",G=d.roles.length?d.roles.join(", "):"-",q=document.createElement("tr");q.className="border-b hover:bg-gray-50",q.innerHTML=`
      <td class="p-2 text-center">
    <input type="checkbox" class="selectUserCheckbox w-4 h-4" data-id="${d.id}">
  </td>  
      <td class="p-2">${f++}</td>
        <td class="p-2 text-left">${d.nama||"-"}</td>
        <td class="p-2">${d.email||"-"}</td>
        <td class="p-2 capitalize">${d.role||"-"}</td>
        <td class="p-2">${G}</td>
        <td class="p-2">${h}</td>
        <td class="p-2">${k}</td>
        <td class="p-2">${L}</td>
        <td class="border px-2 py-1">${d.kelasWali||"-"}</td>
        <td class="p-2 text-center space-x-2">
          <button class="px-2 py-1 rounded bg-yellow-500 text-white editUserBtn" data-id="${d.id}">Edit</button>
          <button class="px-2 py-1 rounded bg-red-500 text-white deleteUserBtn" data-id="${d.id}">Hapus</button>
        </td>
      `,n.appendChild(q)});const v=document.getElementById("paginationUsers");if(v&&(v.innerHTML="",g>1))for(let d=1;d<=g;d++){const h=document.createElement("button");h.className=`px-2 py-1 rounded ${d===e?"bg-blue-600 text-white":"bg-gray-200"}`,h.textContent=d,h.onclick=()=>{Be=d,D(t,d,a)},v.appendChild(h)}n.querySelectorAll(".editUserBtn").forEach(d=>{d.addEventListener("click",()=>Pt(d.dataset.id))}),n.querySelectorAll(".deleteUserBtn").forEach(d=>{d.addEventListener("click",()=>Nt(d.dataset.id))})}catch(s){console.error("Gagal load users:",s),o("Gagal memuat pengguna","bg-red-600")}}}C&&C.addEventListener("change",t=>{const e=t.target.value||"";Be=1;const a=document.getElementById("limitUsers")?.value||"10";D(e,1,a)});const ut=document.getElementById("limitUsers");ut&&ut.addEventListener("change",t=>{Be=1,D(C?.value||"",1,t.target.value)});async function mt(){try{const t=await I(E(m,"kelas")),e=document.getElementById("kelasSelectSiswa");if(!e)return;t.forEach(a=>{const n=a.data(),s=n.namaKelas||n.nama||n.name||"";if(!s)return;const i=document.createElement("option");i.value=s,i.textContent=s,e.appendChild(i)}),console.log("‚úÖ Daftar kelas berhasil dimuat")}catch(t){console.error("‚ùå Gagal memuat kelas:",t)}}window.addEventListener("DOMContentLoaded",mt);async function Pt(t){try{const e=await He(y(m,"users",t));if(!e.exists()){o("Data pengguna tidak ditemukan","bg-red-600");return}const a=e.data();if(document.querySelectorAll(".mapelCheckbox").forEach(s=>{s.checked=Array.isArray(a.mapel)&&a.mapel.includes(s.value)}),re&&Ee){if(ze.value=t,Re.value=a.nama||"",Fe.value=a.email||"",We.value=a.role||"guru",Oe.value=Array.isArray(a.mapel)?a.mapel.join(", "):a.mapel||"",Qe.value=a.kelas||"",W){const s=await I(E(m,"kelas"));W.innerHTML='<option value="">-- Pilih Kelas --</option>',s.forEach(i=>{const l=i.data(),r=l.namaKelas||l.name||"";if(r){const g=document.createElement("option");g.value=r,g.textContent=r,W.appendChild(g)}})}W.value=a.kelasWali||"",W.value=a.kelasWali||"",re.classList.remove("hidden");return}if(oe&&ke){Ue.value=t,qe.value=a.nama||"",Je.value=a.email||"",Pe.value=Array.isArray(a.mapel)?a.mapel.join(", "):a.mapel||"",Ne.value=a.role||"guru",oe.classList.remove("hidden");return}const n=Array.isArray(a.roles)?a.roles:[];document.querySelectorAll(".editRoleCheckbox").forEach(s=>{s.checked=n.includes(s.value)}),o("Modal edit tidak ditemukan di HTML","bg-yellow-600")}catch(e){console.error(e),o("Gagal memuat data pengguna","bg-red-600")}}Ye&&Ye.addEventListener("click",()=>re.classList.add("hidden")),Xe&&Xe.addEventListener("click",()=>oe.classList.add("hidden")),Ee&&Ee.addEventListener("submit",async t=>{t.preventDefault();const e=ze.value,a=Re.value.trim(),n=Fe.value.trim(),s=We.value,i=Oe.value.split(",").map(c=>c.trim()).filter(Boolean),l=Qe.value.trim(),r=document.querySelectorAll(".editRoleCheckbox"),g=Array.from(r).filter(c=>c.checked).map(c=>c.value);await $(y(m,"users",e),{nama:a,email:n,role:s,mapel:s==="guru"?i:[],kelas:s==="ketua_kelas"?l:"",roles:g,updatedAt:$t()});try{await $(y(m,"users",e),{nama:a,email:n,role:s,roles:g,mapel:s==="guru"?i:[],kelas:s==="ketua_kelas"?l:"",kelasWali:W?.value||"",updatedAt:$t()}),o("‚úÖ Data pengguna diperbarui","bg-green-600"),re.classList.add("hidden"),await D(C?.value||"")}catch(c){console.error(c),o("Gagal memperbarui pengguna","bg-red-600")}}),ke&&ke.addEventListener("submit",async t=>{t.preventDefault();const e=Ue.value,a=qe.value.trim(),n=Je.value.trim(),s=Ne.value,i=Pe.value.split(",").map(r=>r.trim()).filter(Boolean),l=data.roles||[];document.querySelectorAll(".editRoleCheckbox").forEach(r=>{r.checked=l.includes(r.value)});try{await $(y(m,"users",e),{nama:a,email:n,role:s,mapel:s==="guru"?i:[]}),o("‚úÖ Data pengguna diperbarui","bg-green-600"),oe.classList.add("hidden"),await D(C?.value||"")}catch(r){console.error(r),o("Gagal memperbarui pengguna","bg-red-600")}});async function Nt(t){if(confirm("Yakin ingin menghapus akun ini?"))try{await J(y(m,"users",t));try{await J(y(m,"guru",t))}catch{}o("üóëÔ∏è Akun dihapus","bg-red-600"),await D(C?.value||"")}catch(e){console.error(e),o("Gagal menghapus akun","bg-red-600")}}const gt=document.getElementById("btnDeleteSelectedUsers"),ce=document.getElementById("selectAllUsers");gt&&ce&&(ce.addEventListener("change",()=>{document.querySelectorAll(".selectUserCheckbox").forEach(e=>e.checked=ce.checked)}),gt.addEventListener("click",async()=>{const t=Array.from(document.querySelectorAll(".selectUserCheckbox:checked")).map(e=>e.dataset.id);if(!t.length)return o("Tidak ada akun yang dipilih","bg-yellow-600");if(confirm(`Yakin ingin menghapus ${t.length} akun?`)){p(!0);try{for(const e of t){await J(y(m,"users",e));try{await J(y(m,"guru",e))}catch{}}o(`üóëÔ∏è ${t.length} akun dihapus`,"bg-green-600"),await D(C?.value||"")}catch(e){console.error(e),o("Gagal hapus massal user","bg-red-600")}finally{p(!1),ce.checked=!1}}}));const pt=document.getElementById("btnDeleteSelectedSiswa"),ue=document.getElementById("selectAllSiswa");pt&&ue&&(ue.addEventListener("change",()=>{document.querySelectorAll(".selectSiswaCheckbox").forEach(e=>e.checked=ue.checked)}),pt.addEventListener("click",async()=>{const t=Array.from(document.querySelectorAll(".selectSiswaCheckbox:checked")).map(e=>e.dataset.id);if(!t.length)return o("Tidak ada siswa yang dipilih","bg-yellow-600");if(confirm(`Yakin ingin menghapus ${t.length} siswa?`)){p(!0);try{for(const e of t)await J(y(m,"siswa",e));o(`üóëÔ∏è ${t.length} siswa dihapus`,"bg-green-600"),await A(B?.value||"")}catch(e){console.error(e),o("Gagal hapus massal siswa","bg-red-600")}finally{p(!1),ue.checked=!1}}})),T&&T.addEventListener("submit",async t=>{t.preventDefault(),p(!0);const e=(document.getElementById("nama")?.value||"").trim(),a=(document.getElementById("email")?.value||"").trim(),n=(document.getElementById("password")?.value||"").trim(),s=document.querySelectorAll(".mapelCheckbox:checked"),i=Array.from(s).map(u=>u.value),l=document.querySelectorAll(".kelasDiajarCheckbox:checked"),r=Array.from(l).map(u=>u.value),g=document.getElementById("role")?.value||"guru",c=le?.checked||!1,w=c&&R?.value||"";if(!e||!a||!n){o("Nama, email, dan password wajib diisi","bg-yellow-600"),p(!1);return}try{if(!(await I(ie(E(m,"users"),Ke("email","==",a)))).empty){o("Email sudah terdaftar di pengguna","bg-yellow-600"),p(!1);return}const f=await Gt(X,a,n),v=document.querySelectorAll(".roleCheckbox"),d=Array.from(v).filter(h=>h.checked).map(h=>h.value);await be(y(m,"users",f.user.uid),{uid:f.user.uid,nama:e,email:a,role:g,roles:d,mapel:g==="guru"?i:[],kelasDiajar:g==="guru"?r:[],waliKelas:g==="guru"?c:!1,kelasWali:g==="guru"&&c?w:"",kelas:g==="ketua_kelas"?w:"",dibuatPada:new Date().toISOString()}),(g==="guru"||g==="kepsek")&&await be(y(m,"guru",f.user.uid),{uid:f.user.uid,nama:e,email:a,role:g,mapel:i,kelasDiajar:r,waliKelas:c,kelasWali:w,dibuatPada:new Date().toISOString()}),o("‚úÖ Akun berhasil ditambahkan!","bg-green-600"),T.reset(),F&&F.classList.add("hidden"),await D(C?.value||""),de("subSectionDaftarAkun")}catch(u){console.error("Gagal menambah user:",u),o("Gagal menambahkan akun: "+(u.message||u),"bg-red-600")}finally{p(!1)}});let U=[],ft=1;async function A(t="",e=1,a="10"){const n=Mt;if(n){n.innerHTML="";try{const s=await I(E(m,"siswa"));if(U=[],s.forEach(u=>{const f=u.data();t&&(f.kelas||"").toLowerCase()!==t.toLowerCase()||U.push({id:u.id,...f})}),U.length===0){n.innerHTML='<tr><td colspan="6" class="p-3 text-gray-500 italic">Tidak ada data siswa</td></tr>';return}const i=a==="all"?U.length:parseInt(a),l=Math.ceil(U.length/i),r=(e-1)*i,g=r+i;U.slice(r,g).forEach(u=>{const f=u.qr_url?`<img src="${u.qr_url}" class="mx-auto w-16 h-16 mb-1 rounded" /> <a href="${u.qr_url}" download="QR_${u.nama||"siswa"}.png" class="block text-xs mt-1 text-blue-600">Download</a>`:'<span class="text-gray-400 italic">Belum ada</span>',v=document.createElement("tr");v.className="border-b hover:bg-gray-50",v.innerHTML=`
        <td class="p-2 text-center">
          <input type="checkbox" class="selectSiswaCheckbox w-4 h-4" data-id="${u.id}">
        </td>
        <td class="p-2">${u.nama||"-"}</td>
        <td class="p-2">${u.kelas||"-"}</td>
        <td class="p-2">${u.nis||"-"}</td>
        <td class="p-2 text-center">${f}</td>
        <td class="p-2 text-center">
          <button class="px-2 py-1 bg-blue-500 text-white rounded editSiswaBtn" data-id="${u.id}">Edit</button>
          <button class="px-2 py-1 bg-red-500 text-white rounded delSiswaBtn" data-id="${u.id}">Hapus</button>
        </td>`,n.appendChild(v)});const w=document.getElementById("paginationSiswa");if(w&&(w.innerHTML="",l>1))for(let u=1;u<=l;u++){const f=document.createElement("button");f.className=`px-2 py-1 rounded ${u===e?"bg-blue-600 text-white":"bg-gray-200"}`,f.textContent=u,f.onclick=()=>A(t,u,a),w.appendChild(f)}n.querySelectorAll(".editSiswaBtn").forEach(u=>{u.addEventListener("click",()=>Xt(u.dataset.id))}),n.querySelectorAll(".delSiswaBtn").forEach(u=>{u.addEventListener("click",()=>zt(u.dataset.id))})}catch(s){console.error("Gagal load siswa:",s),o("Gagal memuat siswa","bg-red-600")}}}document.getElementById("limitSiswa")?.addEventListener("change",t=>{ft=1,A("",ft,t.target.value)});function Xt(t){const e=document.getElementById("modalEditSiswa");if(!e){o("Modal edit siswa tidak ditemukan","bg-yellow-600");return}He(y(m,"siswa",t)).then(a=>{if(!a.exists())return o("Data siswa tidak ditemukan","bg-red-600");const n=a.data();document.getElementById("editId").value=t,document.getElementById("editNama").value=n.nama||"",document.getElementById("editKelas").value=n.kelas||"",document.getElementById("editNis").value=n.nis||"",e.classList.remove("hidden")}).catch(a=>{console.error(a),o("Gagal memuat data siswa","bg-red-600")})}document.getElementById("formEditSiswa")?.addEventListener("submit",async t=>{t.preventDefault();const e=document.getElementById("editId").value,a=document.getElementById("editNama").value.trim(),n=document.getElementById("editKelas").value.trim(),s=document.getElementById("editNis").value.trim();try{await $(y(m,"siswa",e),{nama:a,kelas:n,nis:s}),o("‚úÖ Data siswa diperbarui","bg-green-600"),document.getElementById("modalEditSiswa").classList.add("hidden"),await A(B?.value||"")}catch(i){console.error(i),o("Gagal memperbarui data siswa","bg-red-600")}});async function zt(t){if(confirm("Yakin ingin menghapus siswa ini?"))try{await J(y(m,"siswa",t)),o("üóëÔ∏è Siswa dihapus","bg-red-600"),await A(B?.value||"")}catch(e){console.error(e),o("Gagal menghapus siswa","bg-red-600")}}M&&M.addEventListener("submit",async t=>{t.preventDefault(),p(!0);const e=(document.getElementById("namaSiswa")?.value||"").trim(),a=(document.getElementById("kelasSiswa")?.value||"").trim(),n=(document.getElementById("nisSiswa")?.value||"").trim();if(!e||!a){o("Nama dan kelas wajib diisi","bg-yellow-600"),p(!1);return}try{const s=await he(E(m,"siswa"),{nama:e,kelas:a,nis:n,dibuatPada:new Date().toISOString(),qr_url:""}),i=document.createElement("div");new QRCode(i,{text:s.id,width:256,height:256}),await new Promise(r=>setTimeout(r,700));const l=i.querySelector("canvas");if(l){const r=await Le(l,`qr_siswa/${s.id}.png`);await $(y(m,"siswa",s.id),{qr_url:r})}o("‚úÖ Siswa berhasil ditambahkan","bg-green-600"),M.reset(),await A(B?.value||"")}catch(s){console.error(s),o("Gagal menambah siswa","bg-red-600")}finally{p(!1)}}),B&&B.addEventListener("change",t=>{A(t.target.value||"")}),we&&we.addEventListener("change",()=>{const t=we.value;t&&(console.log("üîπ Memuat data siswa kelas:",t),A(t))});const me=document.getElementById("formJenis"),ae=document.getElementById("modalJenis"),bt=document.getElementById("btnTambahJenis"),ht=document.getElementById("btnCloseModal"),ge=document.getElementById("jenisId"),yt=document.getElementById("jenisNama"),Se=document.getElementById("jenisKategori"),wt=document.getElementById("jenisPoin"),kt=E(m,"jenis_pelanggaran");bt&&bt.addEventListener("click",()=>{me&&me.reset(),ge&&(ge.value=""),ae&&ae.classList.remove("hidden")}),ht&&ht.addEventListener("click",()=>ae.classList.add("hidden")),me&&me.addEventListener("submit",async t=>{t.preventDefault();const e=ge?.value?.trim(),a=yt?.value?.trim(),n=Se?.value?.trim()||"-",s=parseInt(wt?.value||"0");if(!a||isNaN(s)){o("Nama dan poin wajib diisi","bg-yellow-600");return}p(!0);try{e?(await $(y(m,"jenis_pelanggaran",e),{nama:a,kategori:n,poin:s,diperbaruiPada:new Date().toISOString()}),o("‚úÖ Jenis pelanggaran diperbarui","bg-green-600")):(await he(kt,{nama:a,kategori:n,poin:s,dibuatPada:new Date().toISOString()}),o("‚úÖ Jenis pelanggaran ditambahkan","bg-green-600")),ae.classList.add("hidden"),await j()}catch(i){console.error(i),o("Gagal menyimpan jenis pelanggaran","bg-red-600")}finally{p(!1)}}),Ve&&Ze&&Ve.addEventListener("click",async()=>{const t=Ze.files[0];if(!t)return o("Pilih file Excel dulu","bg-yellow-600");p(!0);try{const e=await t.arrayBuffer(),a=XLSX.read(e,{type:"array"}),n=a.Sheets[a.SheetNames[0]],s=XLSX.utils.sheet_to_json(n);for(const i of s){const l=i.nama||i.nama_lengkap||"",r=i.email||"",g=i.password||"12345678",c=i.role||"guru",w=(i.mapel||"").split(",").map(k=>k.trim()).filter(Boolean),u=(i.kelasDiajar||i.kelas_diajar||i["Kelas yang Diajar"]||i["kelas yang diajar"]||"").split(",").map(k=>k.trim()).filter(Boolean),f=i.waliKelas===!0||i.waliKelas==="true",v=f&&i.kelasWali||"";if(!l||!r||!(await I(ie(E(m,"users"),Ke("email","==",r)))).empty)continue;const h=await Gt(X,r,g);await be(y(m,"users",h.user.uid),{uid:h.user.uid,nama:l,email:r,role:c,kelas:c==="ketua_kelas"?v:"",mapel:c==="guru"?w:[],dibuatPada:new Date().toISOString()}),(c==="guru"||c==="kepsek")&&await be(y(m,"guru",h.user.uid),{uid:h.user.uid,nama:l,email:r,mapel:w,role:c,waliKelas:f,kelasWali:v,dibuatPada:new Date().toISOString()})}o("Import pengguna berhasil!","bg-green-600"),await D(C?.value||"")}catch(e){console.error(e),o("Gagal import pengguna: "+(e.message||e),"bg-red-600")}finally{p(!1)}}),et&&ve&&et.addEventListener("click",async()=>{const t=ve.files[0];if(!t)return o("Pilih file Excel dulu","bg-yellow-600");p(!0);try{const e=await t.arrayBuffer(),a=XLSX.read(e,{type:"array"}),n=a.Sheets[a.SheetNames[0]],s=XLSX.utils.sheet_to_json(n);for(const i of s){const l=i.nama||"",r=i.kelas||"",g=i.nis||"";if(!l||!r)continue;const c=await he(E(m,"siswa"),{nama:l,kelas:r,nis:g,dibuatPada:new Date().toISOString(),qr_url:""}),w=document.createElement("div");new QRCode(w,{text:c.id,width:256,height:256}),await new Promise(f=>setTimeout(f,500));const u=w.querySelector("canvas");if(u){const f=await Le(u,`qr_siswa/${c.id}.png`);await $(y(m,"siswa",c.id),{qr_url:f})}}o("Import siswa berhasil!","bg-green-600"),await A(B?.value||"")}catch(e){console.error(e),o("Gagal import siswa","bg-red-600")}finally{p(!1),ve.value=""}}),tt&&tt.addEventListener("click",()=>{const t=[{nama:"Budi Santoso",email:"budi@contoh.com",password:"12345678",mapel:"Matematika, IPA",role:"guru",waliKelas:"true",kelasWali:"7A"}],e=XLSX.utils.json_to_sheet(t),a=XLSX.utils.book_new();XLSX.utils.book_append_sheet(a,e,"format_guru"),XLSX.writeFile(a,"Format_Import_Guru.xlsx")}),at&&at.addEventListener("click",()=>{const t=[{nama:"Andi",kelas:"7A",nis:"1001"}],e=XLSX.utils.json_to_sheet(t),a=XLSX.utils.book_new();XLSX.utils.book_append_sheet(a,e,"format_siswa"),XLSX.writeFile(a,"Format_Import_Siswa.xlsx")}),nt&&nt.addEventListener("click",async()=>{p(!0);try{const t=await I(E(m,"siswa"));if(t.empty){o("Belum ada data siswa","bg-yellow-600"),p(!1);return}const e=[];t.forEach(s=>{const i=s.data();e.push({Nama:i.nama||"-",Kelas:i.kelas||"-",NIS:i.nis||"-","Link QR":i.qr_url||"-"})});const a=XLSX.utils.json_to_sheet(e),n=XLSX.utils.book_new();XLSX.utils.book_append_sheet(n,a,"Data_Siswa"),XLSX.writeFile(n,"Data_Siswa.xlsx"),o("‚úÖ Data siswa diunduh","bg-green-600")}catch(t){console.error(t),o("Gagal mengunduh data siswa","bg-red-600")}finally{p(!1)}}),it&&it.addEventListener("click",async()=>{if(confirm("Yakin ingin generate QR untuk semua siswa yang belum punya QR?")){p(!0);try{const t=await I(E(m,"siswa"));let e=0;for(const a of t.docs){const n=a.data();if(n.qr_url&&typeof n.qr_url=="string"&&n.qr_url.startsWith("http"))continue;const s=document.createElement("div");new QRCode(s,{text:a.id,width:256,height:256}),await new Promise(r=>setTimeout(r,400));const i=s.querySelector("canvas");if(!i)continue;const l=await Le(i,`qr_siswa/${a.id}.png`);await $(y(m,"siswa",a.id),{qr_url:l}),e++}o(`‚úÖ QR berhasil dibuat untuk ${e} siswa`,"bg-green-600"),await A(B?.value||"")}catch(t){console.error(t),o("Gagal generate QR otomatis","bg-red-600")}finally{p(!1)}}}),st&&st.addEventListener("click",async()=>{p(!0);try{const{jsPDF:t}=window.jspdf,e=new t({orientation:"portrait",unit:"mm",format:"a4"}),a=document.getElementById("filterKelas")?.value?.trim()||"",n=document.getElementById("kelasSelectSiswa")?.value?.trim()||"",s=a||n||"",i=s?U.filter(b=>(b.kelas||"").toLowerCase()===s.toLowerCase()):U;if(!i.length){o("Tidak ada siswa untuk dicetak","bg-yellow-600"),p(!1);return}if(!i.length){o("Tidak ada siswa untuk dicetak","bg-yellow-600"),p(!1);return}const l=63,r=70,g=5,c=3,w=e.internal.pageSize.getWidth(),u=e.internal.pageSize.getHeight(),f=l*3+g*2,v=r*4+c*3,d=Math.max((w-f)/2,0),h=Math.max((u-v)/2,0);let k=d,L=h,G=0;const q="./assets/logo.png";async function fe(b,x=20,V=20){return new Promise(Z=>{const S=new Image;S.crossOrigin="anonymous",S.onload=function(){const N=document.createElement("canvas");let ee=S.width,te=S.height;const jt=Math.min(x/ee,V/te,1);ee*=jt,te*=jt,N.width=ee,N.height=te,N.getContext("2d").drawImage(S,0,0,ee,te),Z(N.toDataURL("image/png"))},S.onerror=()=>Z(null),S.src=b})}const se=await fe(q,60,60);for(const b of i){e.setDrawColor(180),e.rect(k,L,l,r),e.setFontSize(9),e.setFont("helvetica","bold"),e.text("Kartu SCAN Siswa",k+4,L+8),e.setFontSize(8),e.text("Sekolah",k+4,L+13),se&&e.addImage(se,"PNG",k+l-18,L+3,12,12);const x=document.createElement("div");new QRCode(x,{text:b.id||b.nis||b.nama,width:600,height:600}),await new Promise(N=>setTimeout(N,500));const V=x.querySelector("img");if(V){const ee=k+(l-40)/2,te=L+18;e.addImage(V.src,"PNG",ee,te,40,40)}const Z=L+r-8,S=L+r-4;e.setFont("helvetica","bold"),e.setFontSize(9),e.text(`${b.nama||"-"}`,k+l/2,Z,{align:"center"}),e.setFont("helvetica","normal"),e.setFontSize(8),e.text(`Kelas: ${b.kelas||"-"}`,k+l/2,S,{align:"center"}),G++,k+=l+g,G%3===0&&(k=d,L+=r+c),G%12===0&&G<i.length&&(e.addPage(),k=d,L=h)}e.save("Kartu_Siswa.pdf"),o("‚úÖ Kartu berhasil dibuat","bg-green-600")}catch(t){console.error("Gagal cetak kartu:",t),o("Gagal membuat kartu PDF","bg-red-600")}finally{p(!1)}}),lt&&lt.addEventListener("click",async()=>{try{await _e(X),window.location.href="index.html"}catch(t){console.error("Logout error:",t),o("Logout gagal","bg-red-600")}}),(async()=>{const t=X.currentUser;Te({title:"Dashboard Admin",userEmail:t?t.email:"Admin",onLogout:async()=>{await _e(X),window.location.href="index.html"}}),Me([{id:"btnMenuGuru",label:"Data Akun",onClick:()=>_("sectionGuru")},{id:"btnMenuSiswa",label:"Data Siswa",onClick:()=>_("sectionDataSiswa")},{id:"btnMenuJenis",label:"Jenis Pelanggaran",onClick:()=>_("sectionJenis")},{id:"btnMenuAbsensi",label:"Dashboard Absensi",onClick:()=>_("sectionAbsensi")}]),await Jt(),await D(C?.value||""),await A(B?.value||""),await j(),await pe(filterAbsensiKelas?.value||""),await Ut(),await qt()})();let Q=[],Ae=1;async function pe(t=1,e="10"){const a=document.getElementById("isiTabelAbsensi");if(!a)return;a.innerHTML='<tr><td colspan="6" class="text-center py-3 text-gray-400">‚è≥ Memuat data...</td></tr>';const n=document.getElementById("filterAbsensiKelas"),s=document.getElementById("filterAbsensiTanggal"),i=n?.value?.trim()||"",l=s?.value?.trim()||"";try{const r=ie(E(m,"absensi")),g=await I(r);if(g.empty){a.innerHTML='<tr><td colspan="6" class="text-center text-gray-400 py-3">Belum ada data absensi</td></tr>';return}Q=[];let c={hadir:0,izin:0,sakit:0,alfa:0};if(g.forEach(b=>{const x=b.data(),V=(x.kelas||"").toLowerCase(),Z=(x.tanggal||"").split("T")[0],S=(x.status||"").toLowerCase();i&&V!==i.toLowerCase()||l&&Z!==l||(S==="hadir"?c.hadir++:S==="izin"?c.izin++:S==="sakit"?c.sakit++:S==="alfa"&&c.alfa++,Q.push({id:b.id,...x}))}),Q.length===0){a.innerHTML='<tr><td colspan="6" class="text-center text-gray-400 py-3">Tidak ada data sesuai filter</td></tr>';return}const w=e==="all"?Q.length:parseInt(e),u=Math.ceil(Q.length/w),f=(t-1)*w,v=f+w,d=Q.slice(f,v);let h=f+1,k="";d.forEach(b=>{const x=(b.status||"").toLowerCase();k+=`
        <tr class="border-b hover:bg-gray-50">
          <td class="p-2 text-center">${h++}</td>
          <td class="p-2">${b.nama||"-"}</td>
          <td class="p-2">${b.kelas||"-"}</td>
          <td class="p-2 capitalize">${x}</td>
          <td class="p-2">${b.keterangan||"-"}</td>
          <td class="p-2">${b.tanggal||b.waktu||"-"}</td>
        </tr>`}),a.innerHTML=k;const L=document.getElementById("paginationAbsensi");if(L&&(L.innerHTML="",u>1))for(let b=1;b<=u;b++){const x=document.createElement("button");x.className=`px-2 py-1 rounded ${b===t?"bg-green-600 text-white":"bg-gray-200"}`,x.textContent=b,x.onclick=()=>{Ae=b,pe(b,e)},L.appendChild(x)}const G=document.getElementById("jmlHadir"),q=document.getElementById("jmlIzin"),fe=document.getElementById("jmlSakit"),se=document.getElementById("jmlAlfa");G&&(G.textContent=c.hadir),q&&(q.textContent=c.izin),fe&&(fe.textContent=c.sakit),se&&(se.textContent=c.alfa)}catch(r){console.error("Gagal memuat absensi:",r),a.innerHTML='<tr><td colspan="6" class="text-center text-red-500 py-3">Gagal memuat data absensi</td></tr>'}}const Et=document.getElementById("btnFilterAbsensi");Et&&Et.addEventListener("click",()=>{Ae=1;const t=document.getElementById("limitAbsensi")?.value||"10";pe(1,t)});const vt=document.getElementById("limitAbsensi");vt&&vt.addEventListener("change",t=>{Ae=1,pe(1,t.target.value)}),mt();const ne=document.getElementById("isiTabelAbsensi"),xt=document.getElementById("grafikAbsensi"),Ce=document.getElementById("filterTanggal"),De=document.getElementById("filterKelas"),je=document.getElementById("inputCari"),It=document.getElementById("jmlHadir"),Lt=document.getElementById("jmlIzin"),Bt=document.getElementById("jmlSakit"),St=document.getElementById("jmlAlfa"),At=document.getElementById("jmlTerlambat");let Ge;async function Y(){try{const t=E(m,"absensi");let a=(await I(t)).docs.map(l=>({id:l.id,...l.data()}));const n=Ce?.value;n&&(a=a.filter(l=>l.tanggal===n));const s=De?.value;s&&(a=a.filter(l=>(l.kelas||"").toLowerCase()===s.toLowerCase()));const i=(je?.value||"").toLowerCase();i&&(a=a.filter(l=>(l.nama||"").toLowerCase().includes(i))),Rt(a),Ft(a),Wt(a)}catch(t){console.error("Gagal memuat data absensi:",t),ne&&(ne.innerHTML='<tr><td colspan="6" class="text-center py-4 text-red-500">Gagal memuat data</td></tr>')}}function Rt(t=[]){if(!ne)return;if(!t.length){ne.innerHTML='<tr><td colspan="6" class="text-center py-4 text-gray-400">Tidak ada data absensi</td></tr>';return}let e=1,a="";t.forEach(n=>{const s=(n.status||"-").toLowerCase(),i=s==="hadir"?"text-green-600 font-semibold":s==="izin"?"text-yellow-500 font-semibold":s==="sakit"?"text-blue-500 font-semibold":s==="alfa"?"text-red-500 font-semibold":"text-gray-500",l=n.waktu||n.jam||"-",r=n.keterangan||"-";a+=`
      <tr class="border-b hover:bg-gray-50">
        <td class="px-3 py-2">${e++}</td>
        <td class="px-3 py-2">${n.nama||"-"}</td>
        <td class="px-3 py-2">${n.kelas||"-"}</td>
        <td class="px-3 py-2 ${i}">${n.status||"-"}</td>
        <td class="px-3 py-2">${r}</td>
        <td class="px-3 py-2">${l}</td>
      </tr>
    `}),ne.innerHTML=a}function Ft(t=[]){const e={hadir:0,izin:0,sakit:0,alfa:0,terlambat:0};t.forEach(a=>{const n=(a.status||"").toLowerCase();n.includes("hadir")?e.hadir++:n.includes("izin")?e.izin++:n.includes("sakit")?e.sakit++:n.includes("alfa")&&e.alfa++,a.keterangan&&a.keterangan.toLowerCase().includes("terlambat")&&e.terlambat++}),It&&(It.textContent=e.hadir),Lt&&(Lt.textContent=e.izin),Bt&&(Bt.textContent=e.sakit),St&&(St.textContent=e.alfa),At&&(At.textContent=e.terlambat)}function Wt(t=[]){if(!xt)return;const e={};t.forEach(r=>{const g=r.tanggal||"-",c=(r.status||"").toLowerCase();e[g]||(e[g]={hadir:0,izin:0,sakit:0,alfa:0}),c.includes("hadir")?e[g].hadir++:c.includes("izin")?e[g].izin++:c.includes("sakit")?e[g].sakit++:c.includes("alfa")&&e[g].alfa++});const a=Object.keys(e),n=a.map(r=>e[r].hadir),s=a.map(r=>e[r].izin),i=a.map(r=>e[r].sakit),l=a.map(r=>e[r].alfa);Ge&&Ge.destroy(),Ge=new Chart(xt,{type:"bar",data:{labels:a,datasets:[{label:"Hadir",data:n,backgroundColor:"#22c55e"},{label:"Izin",data:s,backgroundColor:"#eab308"},{label:"Sakit",data:i,backgroundColor:"#3b82f6"},{label:"Alfa",data:l,backgroundColor:"#ef4444"}]},options:{responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:"Grafik Kehadiran Harian"}}}})}Ce&&Ce.addEventListener("change",Y),De&&De.addEventListener("change",Y),je&&je.addEventListener("input",Y),await Y();async function j(){const t=document.getElementById("tableJenis");if(t){t.innerHTML='<tr><td colspan="5" class="py-4 text-gray-400">‚è≥ Memuat data...</td></tr>';try{const e=await I(E(m,"jenis_pelanggaran"));if(e.empty){t.innerHTML='<tr><td colspan="5" class="py-4 text-gray-500 italic">Belum ada jenis pelanggaran</td></tr>';return}t.innerHTML="";let a=1;e.forEach(n=>{const s=n.data(),i=document.createElement("tr");i.className="border-b hover:bg-gray-50",i.innerHTML=`
          <td class="p-2">${a++}</td>
          <td class="p-2 text-left font-medium">${s.nama||"-"}</td>
          <td class="p-2">
            <span class="px-2 py-1 rounded text-xs text-white ${s.kategori==="Ringan"?"bg-green-500":s.kategori==="Sedang"?"bg-yellow-500":"bg-red-500"}">${s.kategori||"-"}</span>
          </td>
          <td class="p-2 font-bold">${s.poin||0}</td>
          <td class="p-2 space-x-1">
            <button class="px-2 py-1 bg-yellow-500 text-white rounded text-xs hover:bg-yellow-600 btnEditJenis" data-id="${n.id}">Edit</button>
            <button class="px-2 py-1 bg-red-500 text-white rounded text-xs hover:bg-red-600 btnDelJenis" data-id="${n.id}">Hapus</button>
          </td>
        `,t.appendChild(i)}),t.querySelectorAll(".btnEditJenis").forEach(n=>{n.addEventListener("click",()=>Ot(n.dataset.id))}),t.querySelectorAll(".btnDelJenis").forEach(n=>{n.addEventListener("click",()=>Qt(n.dataset.id))}),console.log("‚úÖ Jenis Pelanggaran loaded")}catch(e){console.error("Gagal load jenis pelanggaran:",e),t.innerHTML='<tr><td colspan="5" class="py-4 text-red-500">Gagal memuat data</td></tr>'}}}const Ct=document.getElementById("btnTambahJenis");Ct&&Ct.addEventListener("click",()=>{const t=document.getElementById("formJenis");t&&t.reset(),document.getElementById("jenisId").value="";const e=document.getElementById("modalJenis");e&&e.classList.remove("hidden")});const Dt=document.getElementById("btnCloseModal");Dt&&Dt.addEventListener("click",()=>{const t=document.getElementById("modalJenis");t&&t.classList.add("hidden")});async function Ot(t){try{const e=await He(y(m,"jenis_pelanggaran",t));if(!e.exists())return o("Data tidak ditemukan","bg-red-600");const a=e.data();document.getElementById("jenisId").value=t,document.getElementById("jenisNama").value=a.nama||"",document.getElementById("jenisKategori").value=a.kategori||"",document.getElementById("jenisPoin").value=a.poin||0;const n=document.getElementById("modalJenis");n&&n.classList.remove("hidden")}catch(e){console.error(e)}}const $e=document.getElementById("formJenis");$e&&$e.addEventListener("submit",async t=>{t.preventDefault();const e=document.getElementById("jenisId").value,a=document.getElementById("jenisNama").value.trim(),n=document.getElementById("jenisKategori").value,s=parseInt(document.getElementById("jenisPoin").value)||0;if(!a||!n)return o("Lengkapi data","bg-yellow-600");p(!0);try{e?(await $(y(m,"jenis_pelanggaran",e),{nama:a,kategori:n,poin:s}),o("Data diperbarui","bg-green-600")):(await he(E(m,"jenis_pelanggaran"),{nama:a,kategori:n,poin:s,dibuatPada:new Date().toISOString()}),o("Jenis pelanggaran ditambahkan","bg-green-600"));const i=document.getElementById("modalJenis");i&&i.classList.add("hidden"),$e.reset(),await j()}catch(i){console.error(i),o("Gagal menyimpan","bg-red-600")}finally{p(!1)}});async function Qt(t){if(confirm("Hapus jenis pelanggaran ini?"))try{await J(y(m,"jenis_pelanggaran",t)),o("Terhapus","bg-green-600"),await j()}catch(e){console.error(e),o("Gagal menghapus","bg-red-600")}}window.loadJenisPelanggaran=j});
