<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard Admin Sekolah</title>
  <style>
    iframe {
      border: none;
      overflow: hidden;
    }
  </style>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>

<body class="bg-gray-100 text-gray-800 min-h-screen">

  <!-- LOADING OVERLAY -->
  <div id="loadingOverlay" class="hidden fixed inset-0 bg-gray-900 bg-opacity-60 flex flex-col items-center justify-center text-white text-lg z-50">
    <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-500 mb-4"></div>
    <p>Memproses data...</p>
  </div>

  <!-- HEADER -->
  <header class="bg-blue-600 text-white py-4 shadow">
    <div class="max-w-6xl mx-auto flex justify-between items-center px-4">
      <img src="assets/logo.png" alt="Logo Sekolah" class="w-10 h-10 rounded-full bg-white p-1 shadow" />
      <h1 class="text-xl font-bold">DASHBOARD ADMIN SEKOLAH</h1>
      <button id="btnLogout" class="bg-red-500 hover:bg-red-600 px-4 py-2 rounded text-white">Logout</button>
    </div>
  </header>

  <!-- MAIN -->
  <main class="max-w-6xl mx-auto py-8 px-4 space-y-10">
    
    <!-- TAB MENU -->
    <div class="flex space-x-4 mb-4">
      <button id="tabGuru" class="bg-blue-500 text-white px-4 py-2 rounded shadow">ğŸ‘©â€ğŸ« Data Akun</button>
      <button id="tabSiswa" class="bg-gray-300 px-4 py-2 rounded shadow">ğŸ‘¨â€ğŸ“ Data Siswa</button>
      <button id="tabJenis" class="bg-gray-300 px-4 py-2 rounded shadow">âš ï¸ Jenis Pelanggaran</button>
      <button id="tabAbsensi" class="bg-gray-300 px-4 py-2 rounded shadow">ğŸ“Š Dashboard Absensi</button>
    </div>

    <!-- ========================= GURU ========================= -->
    <!-- BAGIAN GURU (TIDAK DIUBAH SAMA SEKALI) -->
    <section id="sectionGuru" class="space-y-6">
      <h2 class="text-lg font-bold border-b-2 border-blue-400 pb-1">ğŸ‘¤ Manajemen Akun Sekolah</h2>
      <form id="formUser" class="bg-white shadow-md rounded p-4 grid grid-cols-2 gap-4">
        <div><label class="block text-sm font-medium">Nama</label>
          <input type="text" id="nama" class="border rounded w-full p-2" required /></div>
        <div><label class="block text-sm font-medium">Email</label>
          <input type="email" id="email" class="border rounded w-full p-2" required /></div>
        <div><label class="block text-sm font-medium">Password</label>
          <input type="password" id="password" class="border rounded w-full p-2" required /></div>
        <div><label class="block text-sm font-medium">Role Pengguna</label>
          <select id="role" class="border rounded w-full p-2">
            <option value="guru">Guru</option>
            <option value="kepsek">Kepala Sekolah</option>
            <option value="ketua_kelas">Ketua Kelas</option>
          </select>
        </div>
          <div id="mapelContainer" class="col-span-2">
  <label class="block text-sm font-medium mb-1">Pilih Mapel yang Diajarkan</label>
  <div id="listMapelCheckbox" class="grid grid-cols-2 sm:grid-cols-3 gap-1 border rounded p-2 bg-white">
    <p class="text-gray-400 text-sm col-span-full italic">Memuat data mapel...</p>
  </div>  
  <div id="kelasDiajarContainer" class="col-span-2">
  <label class="block text-sm font-medium mb-1">Pilih Kelas yang Diajar</label>
  <div id="listKelasCheckbox" class="grid grid-cols-2 sm:grid-cols-3 gap-1 border rounded p-2 bg-white">
    <p class="text-gray-400 text-sm col-span-full italic">Memuat data kelas...</p>
  </div>
</div>
</div>
                <div>
  <label class="block text-sm font-medium mb-1">Peran Guru</label>
  <div class="flex flex-col gap-1 border rounded p-2">
    <label><input type="checkbox" value="mapel" class="roleCheckbox"> Guru Mapel</label>
    <label><input type="checkbox" value="piket" class="roleCheckbox"> Petugas Piket</label>
  </div>
</div>
        <div class="flex items-center mt-6">
          <input type="checkbox" id="waliKelas" class="mr-2">
          <label for="waliKelas">Juga sebagai Wali Kelas</label>
        </div>
        <div id="kelasContainer" class="hidden">
          <label class="block text-sm font-medium">Pilih Kelas Wali</label>
          <select id="kelasWali" class="border rounded w-full p-2"></select>
        </div>
        <div class="col-span-2">
          <button type="submit" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded w-full font-semibold">
            â• Tambah Akun
          </button>
        </div>
              </form>
      <!-- ========================= MAPEL SECTION ========================= -->
<section id="sectionMapel" class="bg-white shadow-md rounded p-4 mb-6">
  <h2 class="text-lg font-bold border-b-2 border-green-400 pb-1 mb-3">ğŸ“š Data Mata Pelajaran</h2>

  <!-- Form Tambah Mapel -->
  <form id="formMapel" class="flex flex-wrap gap-2 mb-4">
    <input type="text" id="namaMapel" placeholder="Nama Mapel" class="border p-2 rounded flex-1" required>
    <input type="text" id="kodeMapel" placeholder="Kode (Opsional)" class="border p-2 rounded w-40">
    <button type="submit" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded">
      â• Tambah Mapel
    </button>
  </form>

  <!-- Daftar Mapel -->
  <div class="overflow-x-auto">
    <table class="min-w-full text-sm border border-gray-200 rounded">
      <thead class="bg-green-500 text-white">
        <tr>
          <th class="p-2 border">No</th>
          <th class="p-2 border">Nama Mapel</th>
          <th class="p-2 border">Kode</th>
          <th class="p-2 border text-center">Aksi</th>
        </tr>
      </thead>
      <tbody id="tableMapel" class="bg-gray-50 text-center"></tbody>
    </table>
  </div>
</section>

      <!-- ğŸ”¹ FILTER + TABEL SEMUA USER -->
<section id="dataUser" class="mt-4">
  <div class="flex items-center gap-2 mb-3">
    <label for="filterRole" class="font-medium">Filter Peran:</label>
    <select id="filterRole" class="border px-2 py-1 rounded">
      <option value="">Semua</option>
      <option value="guru">Guru</option>
      <option value="kepsek">Kepala Sekolah</option>
      <option value="ketua_kelas">Ketua Kelas</option>
    </select>
  </div>
<button id="btnDeleteSelectedUsers" class="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded">
    ğŸ—‘ï¸ Hapus Terpilih
  </button>
  <div class="bg-white rounded shadow-md overflow-x-auto">
    <table class="min-w-[900px] w-full text-sm border-collapse">
        <thead class="bg-blue-500 text-white">
        <tr>
          <th class="p-2 border">
      <input type="checkbox" id="selectAllUsers" class="w-4 h-4">
    </th>
          <th class="p-2 border">No</th>
          <th class="p-2 border">Nama</th>
          <th class="p-2 border">Email</th>
          <th class="p-2 border">Role</th>
          <th class="p-2 border">Peran Guru</th>
          <th class="p-2 border">Mapel</th>
          <th class="p-2 border">Kelas yang Diajar</th>
          <th class="p-2 border">Kelas</th>
          <th class="border px-2 py-1">Kelas Wali</th>
          <th class="p-2 border text-center">Aksi</th>
        </tr>
      </thead>
      <tbody id="tableUser" class="text-center bg-gray-50"></tbody>
    </table>
  </div>
</section>

      <div class="bg-white shadow-md rounded p-4">
        <h3 class="font-bold mb-2">ğŸ“¥ Import Data Guru dari Excel</h3>
        <div class="flex flex-wrap gap-2 items-center">
          <button id="btnDownloadGuruFormat" class="bg-gray-700 hover:bg-gray-800 text-white px-3 py-1 rounded">â¬‡ï¸ Unduh Format</button>
          <input type="file" id="fileGuru" accept=".xlsx,.xls" class="border p-2 rounded" />
          <button id="btnImportGuru" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded">Import</button>
        </div>
        <p class="text-sm text-gray-500 mt-2">
          Format: nama | email | password | mapel | role | waliKelas | kelasWali
        </p>
      </div>
    </section>

    <!-- ========================= SISWA ========================= -->
         <!-- ğŸ”¹ Filter & Download Controls -->
    <section id="sectionSiswa" class="hidden space-y-6">
      <h2 class="text-lg font-bold border-b-2 border-green-400 pb-1">ğŸ‘¨â€ğŸ“ Daftar Siswa</h2>
      <form id="formSiswa" class="bg-white shadow-md rounded p-4 grid grid-cols-2 gap-4">
        <div><label class="block text-sm font-medium">Nama</label>
          <input type="text" id="namaSiswa" class="border rounded w-full p-2" required /></div>
        <div><label class="block text-sm font-medium">Kelas</label>
          <select id="kelasSiswa" class="border rounded w-full p-2 bg-white" required>
    <option value="">-- Pilih Kelas --</option>
  </select>
</div>
        <div><label class="block text-sm font-medium">NIS</label>
          <input type="text" id="nisSiswa" class="border rounded w-full p-2" required /></div>
                <div class="col-span-2">
          <button type="submit" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded w-full font-semibold">
            â• Tambah Siswa
          </button>
        </div>
      </form>

<!-- Tempat menampilkan kartu siswa -->
<div id="gridSiswa" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mt-4"></div>
<div class="flex items-center gap-3 mb-3">
<button id="btnDeleteSelectedSiswa" class="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded">
  ğŸ—‘ï¸ Hapus Terpilih
</button>
      <select id="kelasSelectSiswa" class="form-select border rounded p-2">
      <option value="">-- Pilih Kelas --</option>
    </select>
    </div>
        <div class="bg-white rounded shadow-md overflow-x-auto">
        <table class="min-w-full text-sm">
          <thead class="bg-green-600 text-white">
            <tr>
              <th class="p-2 border">
      <input type="checkbox" id="selectAllSiswa" class="w-4 h-4">
    </th>
              <th class="p-2">Nama</th>
              <th class="p-2">Kelas</th>
              <th class="p-2">NIS</th>
              <th class="p-2">QR Code</th>
              <th class="p-2">Aksi</th>
            </tr>
          </thead>
          <tbody id="tableSiswa" class="text-center bg-gray-50"></tbody>
        </table>
<div class="flex items-center justify-between mt-3">
  <div>
    <label class="text-sm">Tampilkan:</label>
    <select id="limitSiswa" class="border rounded px-2 py-1">
      <option value="10">10</option>
      <option value="15">15</option>
      <option value="20">20</option>
      <option value="50">50</option>
      <option value="all">Semua</option>
    </select>
    <span class="text-sm ml-1">siswa per halaman</span>
  </div>
  <div id="paginationSiswa" class="space-x-2"></div>
</div>

      </div>


      <div class="bg-white shadow-md rounded p-4">
        <h3 class="font-bold mb-2">ğŸ“¥ Import Data Siswa dari Excel</h3>
        <button id="btnDownloadSiswa" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded">
    â¬‡ï¸ Download Data Siswa (Excel)
  </button>
  <!-- âœ… Tambahkan tombol baru untuk cetak kartu -->
<button id="btnDownloadKartu" class="bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded">
  ğŸ–¨ï¸ Cetak Kartu Pelajar (PDF)
</button>
<!-- Tambahkan tombol ini -->
  <button id="btnGenerateQR" class="bg-purple-600 hover:bg-purple-700 text-white px-3 py-2 rounded">
    ğŸŒ€ Generate QR Otomatis
  </button>
        <div class="flex flex-wrap gap-2 items-center">
          <button id="btnDownloadSiswaFormat" class="bg-gray-700 hover:bg-gray-800 text-white px-3 py-1 rounded">â¬‡ï¸ Unduh Format</button>
          <input type="file" id="fileSiswa" accept=".xlsx,.xls" class="border p-2 rounded" />
          <button id="btnImportSiswa" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded">Import</button>
        </div>
        <p class="text-sm text-gray-500 mt-2">
          Format: nama | kelas | nis
        </p>
      </div>
    </section>

    <!-- ========================= JENIS PELANGGARAN ========================= -->
<section id="sectionJenis" class="hidden space-y-6">
  <h2 class="text-lg font-bold border-b-2 border-yellow-400 pb-1">âš ï¸ Jenis Pelanggaran</h2>
  <button id="btnTambahJenis" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded mb-4">â• Tambah Jenis Pelanggaran</button>

  <div class="bg-white rounded shadow-md overflow-x-auto">
    <table class="min-w-full text-sm">
      <thead class="bg-yellow-500 text-white">
        <tr>
          <th class="p-2">No</th>
          <th class="p-2">Jenis Pelanggaran</th>
          <th class="p-2">Kategori</th>
          <th class="p-2">Poin</th>
          <th class="p-2">Aksi</th>
        </tr>
      </thead>
      <tbody id="tableJenis" class="text-center bg-gray-50"></tbody>
    </table>
  </div>

  <!-- Modal Tambah/Edit -->
  <div id="modalJenis" class="hidden fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white rounded p-6 w-96">
      <h3 class="text-lg font-bold mb-4">Tambah/Edit Jenis Pelanggaran</h3>
      <form id="formJenis">
        <input type="hidden" id="jenisId">
        <div class="mb-3">
          <label class="block text-sm font-medium mb-1">Nama Jenis Pelanggaran</label>
          <input type="text" id="jenisNama" class="border rounded w-full p-2" required>
        </div>
        <div class="mb-3">
  <label class="block text-sm font-medium mb-1">Kategori</label>
  <select id="jenisKategori" class="border rounded w-full p-2" required>
    <option value="">-- Pilih Kategori --</option>
    <option value="Ringan">Ringan</option>
    <option value="Sedang">Sedang</option>
    <option value="Berat">Berat</option>
  </select>
</div>

        <div class="mb-3">
          <label class="block text-sm font-medium mb-1">Poin</label>
          <input type="number" id="jenisPoin" class="border rounded w-full p-2" min="0" required>
        </div>
        <div class="flex justify-end space-x-2">
          <button type="button" id="btnCloseModal" class="px-4 py-2 rounded bg-gray-300 hover:bg-gray-400">Batal</button>
          <button type="submit" class="px-4 py-2 rounded bg-yellow-500 hover:bg-yellow-600 text-white">Simpan</button>
        </div>
      </form>
    </div>
  </div>
</section>

  </main>

<!-- ========================= DASHBOARD ABSENSI ========================= -->
<section id="sectionAbsensi" class="hidden space-y-6">
  <h1 class="text-2xl font-bold text-center mb-2 text-gray-700">ğŸ“Š Dashboard Absensi Sekolah</h1>
  <p class="text-sm text-center text-gray-500 mb-6">Pantau kehadiran siswa secara real-time</p>

  <!-- Filter -->
  <div class="flex gap-2 mb-4 justify-center">
  <input type="date" id="filterAbsensiTanggal" class="border px-3 py-2 rounded shadow-sm focus:ring-2 focus:ring-green-400">
  <select id="filterAbsensiKelas" class="border px-3 py-2 rounded shadow-sm focus:ring-2 focus:ring-green-400">
    <option value="">Semua Kelas</option>
    <option value="7A">7A</option>
    <option value="7B">7B</option>
    <option value="8A">8A</option>
    <option value="9A">9A</option>
  </select>
  <button id="btnFilterAbsensi" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">Terapkan</button>
</div>


  <!-- Statistik Cepat -->
  <div id="statistik" class="grid grid-cols-2 md:grid-cols-5 gap-3 mb-6">
    <div class="bg-white shadow rounded-lg p-4 text-center">
      <h2 class="text-2xl font-bold text-green-600" id="jmlHadir">0</h2>
      <p class="text-sm text-gray-500">Hadir</p>
    </div>
    <div class="bg-white shadow rounded-lg p-4 text-center">
      <h2 class="text-2xl font-bold text-yellow-500" id="jmlIzin">0</h2>
      <p class="text-sm text-gray-500">Izin</p>
    </div>
    <div class="bg-white shadow rounded-lg p-4 text-center">
      <h2 class="text-2xl font-bold text-blue-500" id="jmlSakit">0</h2>
      <p class="text-sm text-gray-500">Sakit</p>
    </div>
    <div class="bg-white shadow rounded-lg p-4 text-center">
      <h2 class="text-2xl font-bold text-red-500" id="jmlAlfa">0</h2>
      <p class="text-sm text-gray-500">Alfa</p>
    </div>
    <div class="bg-white shadow rounded-lg p-4 text-center">
      <h2 class="text-2xl font-bold text-orange-600" id="jmlTerlambat">0</h2>
      <p class="text-sm text-gray-500">Terlambat Hari Ini</p>
    </div>
  </div>

  <!-- Grafik -->
  <div class="p-4 border rounded bg-white shadow">
    <canvas id="grafikAbsensi" width="800" height="400"></canvas>
  </div>

  <!-- Tabel -->
  <div class="overflow-x-auto shadow-md rounded-lg">
    <table class="min-w-full bg-white border border-gray-200" id="tabelAbsensi">
      <thead class="bg-green-600 text-white">
        <tr>
          <th class="py-2 px-3 text-left">No</th>
          <th class="py-2 px-3 text-left">Nama</th>
          <th class="py-2 px-3 text-left">Kelas</th>
          <th class="py-2 px-3 text-left">Status</th>
          <th class="py-2 px-3 text-left">Keterangan</th>
          <th class="py-2 px-3 text-left">Waktu</th>
        </tr>
      </thead>
      <tbody id="isiTabelAbsensi" class="divide-y divide-gray-200">
        <tr><td colspan="6" class="text-center py-4 text-gray-400">â³ Memuat data...</td></tr>
      </tbody>
    </table>
  </div>

  <!-- Rekap per siswa -->
  <div id="rekapSiswa" class="mt-4 text-center text-gray-600"></div>

  <!-- Modal detail siswa -->
  <div id="modalDetail" class="hidden fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50">
    <div class="bg-white p-6 rounded-lg w-96 shadow-lg relative">
      <button id="closeModal" class="absolute top-2 right-3 text-gray-500 hover:text-red-600">âœ•</button>
      <h2 id="detailNama" class="text-lg font-bold text-center mb-2"></h2>
      <p id="detailInfo" class="text-sm text-gray-600 text-center mb-4"></p>
      <canvas id="chartDetail" height="100"></canvas>
    </div>
  </div>

  <footer class="text-center text-xs text-gray-400 mt-6">
    Â© 2025 Sistem Absensi Sekolah â€” Dikembangkan oleh GPT-5 & Hqim18
  </footer>

    </section>


  <!-- Pisahkan JS -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script type="module" src="js/dashboard_admin.js"></script>
 
    <!-- Navigasi Tab -->
  <script>
  // Variabel listener absensi global (bisa diakses dari dashboard_admin.js)
  window.unsubscribeAbsensi = null;
  window.absensiInterval = null;

  const tabGuru = document.getElementById("tabGuru");
  const tabSiswa = document.getElementById("tabSiswa");
  const tabJenis = document.getElementById("tabJenis");
  const tabAbsensi = document.getElementById("tabAbsensi");

  const sectionGuru = document.getElementById("sectionGuru");
  const sectionSiswa = document.getElementById("sectionSiswa");
  const sectionJenis = document.getElementById("sectionJenis");
  const sectionAbsensi = document.getElementById("sectionAbsensi");

  // Fungsi umum untuk sembunyikan semua section
  function showSection(active) {
    const sections = [sectionGuru, sectionSiswa, sectionJenis, sectionAbsensi];
    sections.forEach(s => s.classList.add("hidden"));
    active.classList.remove("hidden");

    // Hentikan listener Firestore dashboard absensi kalau user pindah tab
    if (active !== sectionAbsensi && typeof window.unsubscribeAbsensi === "function") {
      window.unsubscribeAbsensi();
      window.unsubscribeAbsensi = null;
      console.log("Listener Firestore absensi dihentikan âœ…");
    }

    if (active !== sectionAbsensi && window.absensiInterval) {
      clearInterval(window.absensiInterval);
      window.absensiInterval = null;
      console.log("Interval chart absensi dihentikan âœ…");
    }
  }

  tabGuru.addEventListener("click", () => {
    tabGuru.classList.add("bg-blue-500","text-white");
    tabSiswa.classList.remove("bg-blue-500","text-white");
    tabJenis.classList.remove("bg-yellow-500","text-white");
    tabAbsensi.classList.remove("bg-purple-500","text-white");
    showSection(sectionGuru);
  });

  tabSiswa.addEventListener("click", () => {
    tabSiswa.classList.add("bg-blue-500","text-white");
    tabGuru.classList.remove("bg-blue-500","text-white");
    tabJenis.classList.remove("bg-yellow-500","text-white");
    tabAbsensi.classList.remove("bg-purple-500","text-white");
    showSection(sectionSiswa);
  });

  tabJenis.addEventListener("click", () => {
    tabJenis.classList.add("bg-yellow-500","text-white");
    tabGuru.classList.remove("bg-blue-500","text-white");
    tabSiswa.classList.remove("bg-blue-500","text-white");
    tabAbsensi.classList.remove("bg-purple-500","text-white");
    showSection(sectionJenis);
  });

  tabAbsensi.addEventListener("click", () => {
    tabAbsensi.classList.add("bg-purple-500","text-white");
    tabGuru.classList.remove("bg-blue-500","text-white");
    tabSiswa.classList.remove("bg-blue-500","text-white");
    tabJenis.classList.remove("bg-yellow-500","text-white");
    showSection(sectionAbsensi);
  });
</script>
  
    <!-- ğŸ”¹ Modal Edit Siswa -->
<div id="modalEditSiswa" class="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center hidden">
  <div class="bg-white rounded-lg p-6 w-96 shadow-xl">
    <h3 class="text-xl font-semibold mb-4">Edit Data Siswa</h3>
    <form id="formEditSiswa">
      <input type="hidden" id="editId">
      <label class="block mb-1 font-medium">Nama</label>
      <input type="text" id="editNama" class="border rounded w-full p-2 mb-3">
      
      <label class="block mb-1 font-medium">Kelas</label>
      <input type="text" id="editKelas" class="border rounded w-full p-2 mb-3">
      
      <label class="block mb-1 font-medium">NIS</label>
      <input type="text" id="editNis" class="border rounded w-full p-2 mb-3">
      
      <div class="flex justify-end space-x-2 mt-4">
        <button type="button" id="btnCloseEdit" class="px-4 py-2 bg-gray-400 rounded text-white">Batal</button>
        <button type="submit" class="px-4 py-2 bg-green-600 rounded text-white">Simpan</button>
      </div>
    </form>
  </div>
</div>

<!-- ğŸ”¹ Modal Edit Guru -->
<div id="modalEditGuru" class="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center hidden">
  <div class="bg-white rounded-lg p-6 w-96 shadow-xl">
    <h3 class="text-xl font-semibold mb-4">Edit Data Guru</h3>
    <form id="formEditGuru">
      <input type="hidden" id="editGuruId">
      <label class="block mb-1 font-medium">Nama</label>
      <input type="text" id="editGuruNama" class="border rounded w-full p-2 mb-3" />

      <label class="block mb-1 font-medium">Email</label>
      <input type="email" id="editGuruEmail" class="border rounded w-full p-2 mb-3" />

      <label class="block mb-1 font-medium">Mapel</label>
      <input type="text" id="editGuruMapel" class="border rounded w-full p-2 mb-3" placeholder="Pisahkan dengan koma" />

      <label class="block mb-1 font-medium">Role</label>
      <select id="editGuruRole" class="border rounded w-full p-2 mb-3">
        <option value="guru">Guru</option>
        <option value="kepsek">Kepala Sekolah</option>
        <option value="ketua_kelas">Ketua Kelas</option>
      </select>
<div>
  <label class="block text-sm font-medium mb-1">Peran Guru</label>
  <div id="editRoleCheckboxes" class="flex flex-col gap-1 border rounded p-2">
    <label><input type="checkbox" value="mapel" class="editRoleCheckbox"> Guru Mapel</label>
    <label><input type="checkbox" value="piket" class="editRoleCheckbox"> Petugas Piket</label>
  </div>
</div>
      <div class="flex justify-end space-x-2 mt-4">
        <button type="button" id="btnCloseEditGuru" class="px-4 py-2 bg-gray-400 rounded text-white">Batal</button>
        <button type="submit" class="px-4 py-2 bg-green-600 rounded text-white">Simpan</button>
      </div>
    </form>
  </div>
</div>

<!-- JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>

<!-- Modal Edit User -->
<div id="modalEditUser" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg p-6 w-96 shadow-lg">
    <h3 class="text-lg font-semibold mb-4">Edit Data Pengguna</h3>
    <form id="formEditUser" class="space-y-3">
      <input type="hidden" id="editUserId">

      <div>
        <label class="block text-sm font-medium">Nama</label>
        <input id="editUserNama" type="text" class="border px-2 py-1 w-full rounded">
      </div>

      <div>
        <label class="block text-sm font-medium">Email</label>
        <input id="editUserEmail" type="email" class="border px-2 py-1 w-full rounded">
      </div>

      <div>
        <label class="block text-sm font-medium">Role</label>
        <select id="editUserRole" class="border px-2 py-1 w-full rounded">
          <option value="guru">Guru</option>
          <option value="kepsek">Kepala Sekolah</option>
          <option value="ketua_kelas">Ketua Kelas</option>
        </select>
      </div>

      <div>
        <label class="block text-sm font-medium">Mapel (opsional)</label>
        <input id="editUserMapel" type="text" placeholder="Pisahkan dengan koma" class="border px-2 py-1 w-full rounded">
      </div>

      <div>
        <label class="block text-sm font-medium">Kelas (jika Ketua Kelas)</label>
        <input id="editUserKelas" type="text" class="border px-2 py-1 w-full rounded">
      </div>

      <div>
  <label class="block text-sm font-medium">Kelas Wali (Opsional)</label>
  <select id="editUserKelasWali" class="border rounded w-full p-2">
    <option value="">Bukan wali kelas</option>
    <option value="7A">7A</option>
    <option value="7B">7B</option>
    <option value="8A">8A</option>
  </select>
</div>

      <div class="flex justify-end gap-2 mt-4">
        <button type="button" id="btnCloseEditUser" class="px-3 py-1 bg-gray-400 text-white rounded">Batal</button>
        <button type="submit" class="px-3 py-1 bg-blue-600 text-white rounded">Simpan</button>
      </div>
    </form>
  </div>
</div>

</body>
</html>
